<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style type="text/css">
        button {
            display: inline-block;
            margin: 20px;
            height: 200px;
            line-height: 200px;
            width: 200px;
            border-radius: 50%;
            background-color: #3cc;
        }
    </style>
</head>
<body>
    <button onClick="postSomeOne()">增加</button>
    <button>更新</button>
    <button>删除</button>
    <button onClick="getAllProducts()">查询</button>
</body>
<script src="zepto.min.js"></script>
<script type="text/javascript">
    let initPrice = 0
    const reqUrl = 'http://localhost:3888/api/products'
    function logger(){
        return console.log.apply(console, arguments)
    }
    function fetchAjax(type, data) {
        $.ajax({
          type: type,
          headers: {
                  'Accept': 'application/json',
                  'Content-Type': 'text/plain'
              },
          dataType: "json",
          url: reqUrl,
          data: data ? JSON.stringify(data) : {},
          contentType: 'application/json',
          success: function(result){
                logger(JSON.stringify(result))
          },
          error: function(err) {
                logger(err)
          }
        })
    }
    function getAllProducts() {
        $.ajax({
            url: reqUrl,
            type: "GET",
            dataType: 'jsonp',
            jsonp: 'callback',
            jsonpCallback:"success_jsonp", //用户定义的callback函数，没有定义的话会jQuery会自动生成以jQuery开头的函数 
            success: function(result){
                logger(result)
            },
        });
    }
    function postSomeOne() {
        let postData = {
            name: 'haha',
            price: initPrice++,
        }
        fetchAjax("POST", postData)
    }
</script>
</html>